{"ast":null,"code":"import { createReducer, on } from '@ngrx/store';\nimport { initialAuthState } from './auth.state';\nimport * as AuthActions from './auth.actions';\nimport { jwtDecode } from 'jwt-decode';\nexport const authReducer = createReducer(initialAuthState, on(AuthActions.setAccessToken, (state, {\n  token\n}) => {\n  const decoded = decodeToken(token);\n  return {\n    ...state,\n    accessToken: token,\n    isLoggedIn: true,\n    privileges: decoded.privileges || [],\n    features: decoded.features || [],\n    role: decoded.role || 'user' // Default to 'user' if role is not present\n  };\n}), on(AuthActions.clearAuthState, () => initialAuthState));\nfunction decodeToken(token) {\n  try {\n    return jwtDecode(token);\n  } catch {\n    return {};\n  }\n}","map":{"version":3,"names":["createReducer","on","initialAuthState","AuthActions","jwtDecode","authReducer","setAccessToken","state","token","decoded","decodeToken","accessToken","isLoggedIn","privileges","features","role","clearAuthState"],"sources":["C:\\Users\\abhis\\OneDrive\\Desktop\\IgKnightWeb\\IgKnightWeb\\src\\app\\core\\services\\auth.reducer.ts"],"sourcesContent":["import { createReducer, on } from '@ngrx/store';\r\nimport { initialAuthState } from './auth.state';\r\nimport * as AuthActions from './auth.actions';\r\nimport { jwtDecode }   from 'jwt-decode';\r\n\r\nexport const authReducer = createReducer(\r\n  initialAuthState,\r\n  on(AuthActions.setAccessToken, (state, { token }) => {\r\n    const decoded: any = decodeToken(token);\r\n    return {\r\n      ...state,\r\n      accessToken: token,\r\n      isLoggedIn: true,\r\n      privileges: decoded.privileges || [],\r\n      features: decoded.features || [],\r\n      role: decoded.role || 'user' // Default to 'user' if role is not present\r\n    };\r\n  }),\r\n\r\n  on(AuthActions.clearAuthState, () => initialAuthState)\r\n);\r\n\r\nfunction decodeToken(token: string): any {\r\n  try {\r\n    return jwtDecode(token);\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAASA,aAAa,EAAEC,EAAE,QAAQ,aAAa;AAC/C,SAASC,gBAAgB,QAAQ,cAAc;AAC/C,OAAO,KAAKC,WAAW,MAAM,gBAAgB;AAC7C,SAASC,SAAS,QAAU,YAAY;AAExC,OAAO,MAAMC,WAAW,GAAGL,aAAa,CACtCE,gBAAgB,EAChBD,EAAE,CAACE,WAAW,CAACG,cAAc,EAAE,CAACC,KAAK,EAAE;EAAEC;AAAK,CAAE,KAAI;EAClD,MAAMC,OAAO,GAAQC,WAAW,CAACF,KAAK,CAAC;EACvC,OAAO;IACL,GAAGD,KAAK;IACRI,WAAW,EAAEH,KAAK;IAClBI,UAAU,EAAE,IAAI;IAChBC,UAAU,EAAEJ,OAAO,CAACI,UAAU,IAAI,EAAE;IACpCC,QAAQ,EAAEL,OAAO,CAACK,QAAQ,IAAI,EAAE;IAChCC,IAAI,EAAEN,OAAO,CAACM,IAAI,IAAI,MAAM,CAAC;GAC9B;AACH,CAAC,CAAC,EAEFd,EAAE,CAACE,WAAW,CAACa,cAAc,EAAE,MAAMd,gBAAgB,CAAC,CACvD;AAED,SAASQ,WAAWA,CAACF,KAAa;EAChC,IAAI;IACF,OAAOJ,SAAS,CAACI,KAAK,CAAC;EACzB,CAAC,CAAC,MAAM;IACN,OAAO,EAAE;EACX;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}