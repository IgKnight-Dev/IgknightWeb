import{a as Y,b as J}from"./chunk-33L46XTC.js";import{h as K}from"./chunk-LM6AGVKW.js";import"./chunk-4LYE5WHQ.js";import{c as X,d as Z,e as $,f as ee,g as te,h as ie,l as ne,m as re,n as ae,o as oe,p as se}from"./chunk-RRUL5IR4.js";import"./chunk-EKD3FAFT.js";import{$a as N,Aa as V,Da as c,Jb as D,Ma as p,Na as n,Nb as G,Oa as i,P as E,Pa as h,Qa as P,Ra as k,Sa as R,Ub as Q,Va as v,W as f,Wa as x,X as u,Y as y,_a as A,ab as q,bc as z,dc as W,eb as g,gb as H,ib as s,jb as B,kb as I,mb as _,nb as w,ob as S,pa as j,ra as o,ub as F,wa as b,za as U}from"./chunk-EFSD2UP6.js";import{j as C}from"./chunk-EJUJSVO6.js";var me=["otpRef"],ce=["captchaRef"];function fe(t,a){t&1&&(n(0,"div"),s(1,"Name is required."),i())}function ue(t,a){t&1&&(n(0,"div"),s(1,"Minimum 3 characters."),i())}function ge(t,a){if(t&1&&(n(0,"div",61),c(1,fe,2,0,"div",43)(2,ue,2,0,"div",43),i()),t&2){x();let r=g(38);o(),p("ngIf",r.errors==null?null:r.errors.required),o(),p("ngIf",r.errors==null?null:r.errors.minlength)}}function he(t,a){t&1&&(n(0,"div"),s(1,"Email is required."),i())}function xe(t,a){t&1&&(n(0,"div"),s(1,"Enter a valid email."),i())}function ve(t,a){if(t&1&&(n(0,"div",61),c(1,he,2,0,"div",43)(2,xe,2,0,"div",43),i()),t&2){x();let r=g(44);o(),p("ngIf",r.errors==null?null:r.errors.required),o(),p("ngIf",r.errors==null?null:r.errors.email)}}function _e(t,a){if(t&1&&(n(0,"span",62),s(1),i()),t&2){let r=x();o(),B(r.otpSentMessage)}}function we(t,a){if(t&1&&(n(0,"div",67),s(1),i()),t&2){let r=x(2);H("text-green-600",r.isOtpVerified)("text-red-600",!r.isOtpVerified),o(),I(" ",r.otpVerifyMessage," ")}}function Se(t,a){if(t&1){let r=R();n(0,"div")(1,"label",63),s(2,"OTP"),i(),n(3,"input",64,7),S("ngModelChange",function(l){f(r);let m=x();return w(m.otp,l)||(m.otp=l),u(l)}),i(),n(5,"button",65),v("click",function(){f(r);let l=x();return u(l.onVerifyOtp())}),s(6),i(),c(7,we,2,5,"div",66),i()}if(t&2){let r=g(4),e=x();o(3),_("ngModel",e.otp),o(2),p("disabled",r.invalid||e.isVerifyingOtp),o(),I(" ",e.isVerifyingOtp?"Verifying...":"Verify OTP"," "),o(),p("ngIf",e.otpVerifyMessage)}}function ye(t,a){t&1&&(n(0,"div",61),s(1,"CAPTCHA is required."),i())}function be(t,a){t&1&&(P(0),y(),n(1,"svg",68),h(2,"path",69)(3,"path",70)(4,"path",71)(5,"path",72),i(),k())}function Me(t,a){t&1&&(y(),n(0,"svg",73),h(1,"path",74)(2,"circle",75),i())}function Ce(t,a){t&1&&(P(0),y(),n(1,"svg",68),h(2,"path",69)(3,"path",70)(4,"path",71)(5,"path",72),i(),k())}function Ee(t,a){t&1&&(y(),n(0,"svg",73),h(1,"path",74)(2,"circle",75),i())}function Ve(t,a){t&1&&(n(0,"div",61),s(1,"Passwords do not match."),i())}function Ie(t,a){t&1&&(n(0,"div"),s(1,"Please fill all required fields correctly."),i())}function Oe(t,a){t&1&&(n(0,"div"),s(1,"Passwords do not match."),i())}function Te(t,a){t&1&&(n(0,"div"),s(1,"Please verify your OTP."),i())}function Pe(t,a){t&1&&(n(0,"div"),s(1,"CAPTCHA is required."),i())}function ke(t,a){if(t&1&&(n(0,"div",76),c(1,Ie,2,0,"div",43)(2,Oe,2,0,"div",43)(3,Te,2,0,"div",43)(4,Pe,2,0,"div",43),i()),t&2){let r=x(),e=g(33),l=g(59);o(),p("ngIf",e.invalid),o(),p("ngIf",r.password!==r.confirm),o(),p("ngIf",!r.isOtpVerified),o(),p("ngIf",l.invalid&&l.touched)}}var O=class t{constructor(a,r,e,l){this.authApi=a;this.otpApi=r;this.http=e;this.toastr=l}fullName="";email="";password="";confirm="";otp="";captchaInput="";originalEmail="";isOtpSent=!1;isOtpVerified=!1;isSendingOtp=!1;isVerifyingOtp=!1;isLoading=!1;showPassword=!1;showConfirmPassword=!1;passwordFocused=!1;confirmFocused=!1;otpSentMessage="";otpVerifyMessage="";errorMessage="";successMessage="";captchaId="";captchaImageUrl="";otpRef;captchaRef;ngOnInit(){this.loadCaptcha()}ngDoCheck(){this.isOtpVerified&&this.email!==this.originalEmail&&(this.isOtpVerified=!1,this.otpVerifyMessage="Email changed. Please re-verify OTP.",this.otp="")}loadCaptcha(){this.otpApi.getCaptcha().then(a=>{this.captchaId=a.captchaId,this.captchaImageUrl=a.imageBase64}).catch(a=>{console.error("Failed to load captcha",a),this.captchaId="",this.captchaImageUrl=""})}onReset(){this.fullName="",this.email="",this.otp="",this.captchaInput="",this.password="",this.confirm="",this.isOtpSent=!1,this.isOtpVerified=!1,this.otpSentMessage="",this.otpVerifyMessage="",this.captchaImageUrl="",this.showPassword=!1,this.showConfirmPassword=!1,this.loadCaptcha?.()}onSendOtp(){return C(this,null,function*(){if(this.email){this.isSendingOtp=!0,this.otpSentMessage="",this.isOtpVerified=!1,this.otpVerifyMessage="",this.otp="";try{let a={email:this.email};yield this.otpApi.sendEmailOtp(a),this.isOtpSent=!0,this.otpSentMessage="OTP sent successfully!"}catch{this.otpSentMessage="Failed to send OTP. Please try again."}finally{this.isSendingOtp=!1}}})}onVerifyOtp(){return C(this,null,function*(){if(this.otp){this.isVerifyingOtp=!0,this.otpVerifyMessage="";try{(yield this.otpApi.verifyOtp("",this.email,1,this.otp))?(this.isOtpVerified=!0,this.originalEmail=this.email,this.otpVerifyMessage="OTP verified successfully!"):(this.isOtpVerified=!1,this.otpVerifyMessage="Invalid OTP. Please try again.")}catch{this.isOtpVerified=!1,this.otpVerifyMessage="Invalid OTP. Please try again."}finally{this.isVerifyingOtp=!1}}})}onSignup(a){return C(this,null,function*(){if(a.invalid||this.password!==this.confirm||!this.isOtpVerified||!this.captchaInput||this.captchaRef.invalid)return;this.isLoading=!0,this.errorMessage="",this.successMessage="";let r={username:this.fullName,email:this.email,password:this.password,captchaId:this.captchaId,captchaToken:this.captchaInput};try{yield this.authApi.RegisterUser(r),this.toastr.success("Registration successful!"),a.resetForm(),this.resetStatesAfterSignup()}catch(e){let l=e?.error?.message||"Signup failed. Please try again.";this.toastr.error(l),this.loadCaptcha()}finally{this.isLoading=!1}})}togglePassword(){this.showPassword=!this.showPassword}resetStatesAfterSignup(){this.isOtpSent=!1,this.isOtpVerified=!1,this.isSendingOtp=!1,this.isVerifyingOtp=!1,this.otpSentMessage="",this.otpVerifyMessage="",this.errorMessage="",this.captchaInput="",this.captchaId="",this.captchaImageUrl="",this.loadCaptcha()}static \u0275fac=function(r){return new(r||t)(b(Y),b(J),b(Q),b(K))};static \u0275cmp=U({type:t,selectors:[["app-signup"]],viewQuery:function(r,e){if(r&1&&(A(me,5),A(ce,5)),r&2){let l;N(l=q())&&(e.otpRef=l.first),N(l=q())&&(e.captchaRef=l.first)}},standalone:!1,decls:89,vars:22,consts:[["signUpForm","ngForm"],["fullNameRef","ngModel"],["emailRef","ngModel"],["captchaRef","ngModel"],["passwordRef","ngModel"],["eyeIcon",""],["confirmRef","ngModel"],["otpRef","ngModel"],[1,"min-h-screen","relative","overflow-hidden","bg-black"],[1,"absolute","inset-0","bg-cover","bg-center","bg-no-repeat",2,"background-image","url('assets/images/login-bg.png')"],[1,"absolute","inset-0","bg-black/30"],[1,"absolute","inset-0","bg-gradient-to-br","from-amber-900/20","via-transparent","to-orange-900/30"],[1,"absolute","top-[68%]","left-[25%]","z-20","max-w-sm"],[1,"relative","backdrop-blur-sm","bg-white/20","rounded-xl","p-4","border","border-white/30","shadow-xl","overflow-hidden"],[1,"text-base","lg:text-lg","font-playfair","text-white","leading-snug","drop-shadow-xl"],[1,"block","-ml-2"],[1,"block","text-amber-200","pl-3"],[1,"mt-4","flex","items-center","space-x-2"],[1,"flex-1","h-0.5","bg-gradient-to-r","from-amber-400","via-orange-500","to-red-500","rounded-full"],[1,"w-2","h-2","bg-amber-400","rounded-full"],[1,"w-1.5","h-1.5","bg-orange-500","rounded-full"],[1,"w-1","h-1","bg-red-500","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-br","from-amber-900/20","via-transparent","to-orange-900/30","rounded-xl","pointer-events-none"],[1,"relative","z-10","min-h-screen","flex","flex-col","justify-center","items-center","px-6","sm:px-10","lg:flex-row","lg:justify-end","lg:pr-20"],[1,"w-full","max-w-[19rem]","sm:max-w-[20rem]","lg:max-w-[22rem]"],[1,"text-center","mt-0","mb-4"],["routerLink","/",1,"inline-flex","items-center","space-x-3","group"],[1,"w-14","h-14","bg-gradient-to-r","from-orange-500","to-red-600","rounded-2xl","flex","items-center","justify-center","group-hover:scale-110","transition-transform","shadow-xl"],[1,"text-white","font-extrabold","text-3xl","select-none"],[1,"text-4xl","font-extrabold","text-white","drop-shadow-lg","tracking-tight","select-none"],[1,"bg-white/90","backdrop-blur-md","rounded-lg","shadow-xl","ring-1","ring-white/20","px-4","py-3","overflow-auto"],[1,"text-center"],[1,"text-xl","sm:text-2xl","font-bold","text-slate-900","mb-1"],[1,"text-slate-700","text-sm","sm:text-base","font-medium","mb-2"],["novalidate","","autocomplete","off",1,"space-y-2",3,"ngSubmit"],["for","fullName",1,"block","text-xs","font-medium","text-slate-800","mb-1"],["id","fullName","name","fullName","required","","minlength","3","placeholder","Your name","autocomplete","off",1,"w-full","h-8","px-2","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","ngModel"],["class","text-xs text-red-600",4,"ngIf"],["for","email",1,"block","text-xs","font-medium","text-slate-800","mb-1"],["id","email","name","email","type","email","required","","email","","placeholder","you@example.com","autocomplete","off",1,"w-full","h-8","px-2","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","ngModel"],[1,"mt-1","flex","justify-between","items-center"],["type","button",1,"text-xs","text-orange-600","font-semibold",3,"click","disabled"],["class","text-xs text-green-600",4,"ngIf"],[4,"ngIf"],["for","captcha",1,"block","text-xs","font-medium","text-slate-800","mb-1"],[1,"flex","items-center","space-x-2"],["alt","CAPTCHA",1,"h-8","border","border-amber-400","rounded",3,"src"],["type","button","aria-label","Refresh CAPTCHA",1,"text-xs","text-orange-600","font-semibold",3,"click"],["id","captcha","name","captcha","required","","placeholder","Enter CAPTCHA","autocomplete","off",1,"w-full","h-8","px-2","mt-1","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","ngModel"],["for","password",1,"block","text-xs","font-medium","text-slate-800","mb-1"],[1,"relative"],["id","password","name","password","required","","minlength","6","placeholder","Create a password","autocomplete","new-password",1,"w-full","h-8","px-2","pr-8","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","type","ngModel"],["type","button","tabindex","-1","aria-label","Toggle password visibility",1,"absolute","inset-y-0","right-2","flex","items-center","text-lg","pr-1","text-slate-700","hover:text-orange-600",3,"click"],[4,"ngIf","ngIfElse"],["for","confirm",1,"block","text-xs","font-medium","text-slate-800","mb-1"],["id","confirm","name","confirm","required","","placeholder","Repeat password","autocomplete","new-password",1,"w-full","h-8","px-2","pr-8","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","type","ngModel"],["type","button","tabindex","-1","aria-label","Toggle confirm password visibility",1,"absolute","inset-y-0","right-2","flex","items-center","text-lg","pr-1","text-slate-700","hover:text-orange-600",3,"click"],["type","submit",1,"w-full","h-8","bg-gradient-to-r","from-orange-600","to-red-600","rounded-md","text-white","font-semibold","text-xs","disabled:opacity-50",3,"disabled"],["class","text-xs text-red-600 mt-1 space-y-1",4,"ngIf"],[1,"text-center","text-xs","text-slate-700","mt-2"],["routerLink","/login",1,"text-orange-600","font-semibold"],[1,"text-xs","text-red-600"],[1,"text-xs","text-green-600"],["for","otp",1,"block","text-xs","font-medium","text-slate-800","mb-1"],["id","otp","name","otp","required","","minlength","4","maxlength","6","placeholder","Enter OTP","autocomplete","off",1,"w-full","h-8","px-2","rounded-md","border","border-amber-300","text-xs",3,"ngModelChange","ngModel"],["type","button","aria-label","Verify OTP",1,"mt-1","w-full","h-8","bg-gradient-to-r","from-orange-600","to-red-600","rounded-md","text-white","font-semibold","text-xs",3,"click","disabled"],["class","text-xs mt-1",3,"text-green-600","text-red-600",4,"ngIf"],[1,"text-xs","mt-1"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-eye-off-icon","lucide-eye-off"],["d","M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"],["d","M14.084 14.158a3 3 0 0 1-4.242-4.242"],["d","M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"],["d","m2 2 20 20"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-eye-icon","lucide-eye"],["d","M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"],["cx","12","cy","12","r","3"],[1,"text-xs","text-red-600","mt-1","space-y-1"]],template:function(r,e){if(r&1){let l=R();n(0,"div",8),h(1,"div",9)(2,"div",10)(3,"div",11),n(4,"div",12)(5,"div",13)(6,"blockquote",14)(7,"span",15),s(8,'"Share the spark,'),i(),n(9,"span",16),s(10,'spread the knowledge"'),i()(),n(11,"div",17),h(12,"div",18)(13,"div",19)(14,"div",20)(15,"div",21),i(),h(16,"div",22),i()(),n(17,"div",23)(18,"div",24)(19,"div",25)(20,"a",26)(21,"div",27)(22,"span",28),s(23,"\u{1F525}"),i()(),n(24,"span",29),s(25,"IGKNIGHT"),i()()(),n(26,"div",30)(27,"div",31)(28,"h2",32),s(29,"Create Your Account"),i(),n(30,"p",33),s(31,"Join the magical library of knowledge"),i()(),n(32,"form",34,0),v("ngSubmit",function(){f(l);let d=g(33);return u(e.onSignup(d))}),n(34,"div")(35,"label",35),s(36,"Full Name"),i(),n(37,"input",36,1),S("ngModelChange",function(d){return f(l),w(e.fullName,d)||(e.fullName=d),u(d)}),i(),c(39,ge,3,2,"div",37),i(),n(40,"div")(41,"label",38),s(42,"Email"),i(),n(43,"input",39,2),S("ngModelChange",function(d){return f(l),w(e.email,d)||(e.email=d),u(d)}),i(),c(45,ve,3,2,"div",37),n(46,"div",40)(47,"button",41),v("click",function(){return f(l),u(e.onSendOtp())}),s(48),i(),c(49,_e,2,1,"span",42),i()(),c(50,Se,8,4,"div",43),n(51,"div")(52,"label",44),s(53,"CAPTCHA"),i(),n(54,"div",45),h(55,"img",46),n(56,"button",47),v("click",function(){return f(l),u(e.loadCaptcha())}),s(57,"Refresh"),i()(),n(58,"input",48,3),S("ngModelChange",function(d){return f(l),w(e.captchaInput,d)||(e.captchaInput=d),u(d)}),i(),c(60,ye,2,0,"div",37),i(),n(61,"div")(62,"label",49),s(63,"Password"),i(),n(64,"div",50)(65,"input",51,4),S("ngModelChange",function(d){return f(l),w(e.password,d)||(e.password=d),u(d)}),i(),n(67,"button",52),v("click",function(){return f(l),u(e.showPassword=!e.showPassword)}),c(68,be,6,0,"ng-container",53)(69,Me,3,0,"ng-template",null,5,F),i()()(),n(71,"div")(72,"label",54),s(73,"Confirm Password"),i(),n(74,"div",50)(75,"input",55,6),S("ngModelChange",function(d){return f(l),w(e.confirm,d)||(e.confirm=d),u(d)}),i(),n(77,"button",56),v("click",function(){return f(l),u(e.showConfirmPassword=!e.showConfirmPassword)}),c(78,Ce,6,0,"ng-container",53)(79,Ee,3,0,"ng-template",null,5,F),i()(),c(81,Ve,2,0,"div",37),i(),n(82,"button",57),s(83," Create Account "),i(),c(84,ke,5,4,"div",58),i(),n(85,"div",59),s(86," Already have an account? "),n(87,"a",60),s(88,"Log in"),i()()()()()()}if(r&2){let l=g(33),m=g(38),d=g(44),M=g(59),L=g(70),pe=g(76);o(37),_("ngModel",e.fullName),o(2),p("ngIf",m.invalid&&m.touched),o(4),_("ngModel",e.email),o(2),p("ngIf",d.invalid&&d.touched),o(2),p("disabled",d.invalid||e.isSendingOtp),o(),I(" ",e.isOtpSent?"Resend OTP":"Send OTP"," "),o(),p("ngIf",e.otpSentMessage),o(),p("ngIf",e.isOtpSent),o(5),p("src",e.captchaImageUrl,j),o(3),_("ngModel",e.captchaInput),o(2),p("ngIf",M.invalid&&M.touched),o(5),p("type",e.showPassword?"text":"password"),_("ngModel",e.password),o(3),p("ngIf",e.showPassword)("ngIfElse",L),o(7),p("type",e.showConfirmPassword?"text":"password"),_("ngModel",e.confirm),o(3),p("ngIf",e.showConfirmPassword)("ngIfElse",L),o(3),p("ngIf",e.password!==e.confirm&&pe.touched),o(),p("disabled",l.invalid||e.password!==e.confirm||!e.isOtpVerified||e.email!==e.originalEmail||M.invalid),o(2),p("ngIf",l.invalid||e.password!==e.confirm||!e.isOtpVerified||M.invalid)}},dependencies:[D,z,ie,X,Z,$,ne,ae,oe,re,te,ee],encapsulation:2})};var Re=[{path:"",component:O}],T=class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=V({type:t});static \u0275inj=E({imports:[W.forChild(Re),W]})};var de=class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=V({type:t});static \u0275inj=E({imports:[G,T,se]})};export{de as RegisterModule};
