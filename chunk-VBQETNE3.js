import{a as J,b as K}from"./chunk-QVRFBSMZ.js";import{c as X}from"./chunk-FQYI7G7Y.js";import{h as Q}from"./chunk-LM6AGVKW.js";import{c as Y,d as Z,e as $,f as ee,g as te,h as ie,l as re,n as ne,p as oe}from"./chunk-RRUL5IR4.js";import{b as z}from"./chunk-DEPGSKJD.js";import"./chunk-2U376WBP.js";import{Aa as b,Da as v,Jb as B,Ma as d,Na as e,Nb as C,Oa as t,P as x,Pa as u,Qa as O,Ra as W,Sa as F,Va as w,W as g,Wa as V,X as f,Y as y,Z as q,_b as H,ac as M,bc as U,dc as P,eb as h,ib as o,mb as k,nb as S,ob as I,pa as D,ra as s,ub as G,wa as p,za as _}from"./chunk-EFSD2UP6.js";import{j as N}from"./chunk-EJUJSVO6.js";function me(i,n){i&1&&(e(0,"div"),o(1,"Username is required."),t())}function ce(i,n){i&1&&(e(0,"div"),o(1,"Minimum 4 characters required."),t())}function pe(i,n){if(i&1&&(e(0,"div",61),v(1,me,2,0,"div",62)(2,ce,2,0,"div",62),t()),i&2){V();let r=h(37);s(),d("ngIf",r.errors==null?null:r.errors.required),s(),d("ngIf",r.errors==null?null:r.errors.minlength)}}function ue(i,n){i&1&&(O(0),y(),e(1,"svg",63),u(2,"path",64)(3,"path",65)(4,"path",66)(5,"path",67),t(),W())}function ge(i,n){i&1&&(y(),e(0,"svg",68),u(1,"path",69)(2,"circle",70),t())}function fe(i,n){i&1&&(e(0,"div"),o(1,"Password is required."),t())}function he(i,n){i&1&&(e(0,"div"),o(1,"Minimum 6 characters required."),t())}function ve(i,n){if(i&1&&(e(0,"div",61),v(1,fe,2,0,"div",62)(2,he,2,0,"div",62),t()),i&2){V();let r=h(44);s(),d("ngIf",r.errors==null?null:r.errors.required),s(),d("ngIf",r.errors==null?null:r.errors.minlength)}}function xe(i,n){i&1&&(e(0,"div",71),o(1,"CAPTCHA is required."),t())}var E=class i{constructor(n,r,a,m,c){this.authApi=n;this.otpApi=r;this.router=a;this.toastr=m;this.tokenService=c}username="";password="";captchaInput="";captchaImageUrl="";captchaId="";isLoading=!1;errorMessage="";showPassword=!1;ngOnInit(){this.loadCaptcha()}togglePasswordVisibility(){this.showPassword=!this.showPassword}loadCaptcha(){this.otpApi.getCaptcha().then(n=>{this.captchaId=n.captchaId,this.captchaImageUrl=n.imageBase64}).catch(n=>{console.error("Failed to load captcha",n),this.captchaId="",this.captchaImageUrl=""})}signInWithGoogle(){this.authApi.loginWithGoogle()}onLogin(){return N(this,null,function*(){this.isLoading=!0,this.errorMessage="";let n={email:this.username,password:this.password,captchaId:this.captchaId,captchaToken:this.captchaInput,ipAddress:this.getIpAddress(),deviceId:this.getDeviceId(),deviceType:this.getDeviceType()};try{let r=yield this.authApi.Login(n);r?.accessToken&&this.tokenService.setTokens(r.accessToken,r.refreshToken),this.toastr.success("Login successful!"),this.router.navigate(["/documentation"])}catch(r){let a=r?.error?.message||"Login failed. Check your credentials and CAPTCHA.";this.toastr.error(a),this.loadCaptcha()}finally{this.isLoading=!1}})}getIpAddress(){}getDeviceId(){return"device-id-placeholder"}getDeviceType(){return"web"}static \u0275fac=function(r){return new(r||i)(p(J),p(K),p(M),p(Q),p(X))};static \u0275cmp=_({type:i,selectors:[["app-login"]],standalone:!1,decls:81,vars:11,consts:[["loginForm","ngForm"],["usernameRef","ngModel"],["passwordRef","ngModel"],["eyeIcon",""],["captchaRef","ngModel"],[1,"min-h-screen","relative","overflow-hidden","bg-black"],[1,"absolute","inset-0","bg-cover","bg-center","bg-no-repeat",2,"background-image","url('assets/images/login-bg.png')"],[1,"absolute","inset-0","bg-black/30"],[1,"absolute","inset-0","bg-gradient-to-br","from-amber-900/20","via-transparent","to-orange-900/30"],[1,"absolute","top-[68%]","left-[25%]","z-20","max-w-sm"],[1,"relative","backdrop-blur-sm","bg-white/20","rounded-xl","p-4","border","border-white/30","shadow-xl","overflow-hidden"],[1,"text-base","lg:text-lg","font-playfair","text-white","leading-snug","drop-shadow-xl"],[1,"block","-ml-2"],[1,"block","text-amber-200","pl-3"],[1,"mt-4","flex","items-center","space-x-2"],[1,"flex-1","h-0.5","bg-gradient-to-r","from-amber-400","via-orange-500","to-red-500","rounded-full"],[1,"w-2","h-2","bg-amber-400","rounded-full"],[1,"w-1.5","h-1.5","bg-orange-500","rounded-full"],[1,"w-1","h-1","bg-red-500","rounded-full"],[1,"absolute","inset-0","bg-gradient-to-br","from-amber-900/20","via-transparent","to-orange-900/30","rounded-xl","pointer-events-none"],[1,"relative","z-10","min-h-screen","flex","flex-col","justify-center","items-center","px-6","sm:px-10","lg:flex-row","lg:justify-end","lg:pr-20"],[1,"w-full","max-w-[19rem]","sm:max-w-[20rem]","lg:max-w-[22rem]"],[1,"text-center","mt-0","mb-4"],["routerLink","/",1,"inline-flex","items-center","space-x-3","group"],[1,"w-14","h-14","bg-gradient-to-r","from-orange-500","to-red-600","rounded-2xl","flex","items-center","justify-center","group-hover:scale-110","transition-transform","shadow-xl"],[1,"text-white","font-extrabold","text-3xl","select-none"],[1,"text-4xl","font-extrabold","text-white","drop-shadow-lg","tracking-tight","select-none"],[1,"bg-white/90","backdrop-blur-md","rounded-lg","shadow-xl","ring-1","ring-white/20","overflow-hidden","px-5","py-4","text-center"],[1,"text-xl","sm:text-2xl","font-bold","text-slate-900","mb-1"],[1,"text-slate-700","text-sm","sm:text-base","font-medium","mb-2"],["novalidate","",1,"space-y-2",3,"ngSubmit"],[1,"text-left"],["for","username",1,"block","text-sm","font-medium","text-slate-800","mb-1"],["id","username","name","username","type","text","required","","minlength","4","autocomplete","username","placeholder","Enter your username",1,"w-full","h-9","px-3","rounded-md","border","border-amber-300","bg-white","text-sm","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-500",3,"ngModelChange","ngModel"],["class","text-xs mt-1 text-red-600 font-medium",4,"ngIf"],["for","password",1,"block","text-sm","font-medium","text-slate-800","mb-1"],[1,"relative"],["id","password","name","password","required","","minlength","6","autocomplete","current-password","placeholder","Enter your password",1,"w-full","h-9","px-3","pr-10","rounded-md","border","border-amber-300","bg-white","text-sm","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-500",3,"ngModelChange","type","ngModel"],["type","button","tabindex","-1",1,"absolute","inset-y-0","right-2","flex","items-center","text-xl","pr-1","text-slate-700","hover:text-orange-600",3,"click"],[4,"ngIf","ngIfElse"],[1,"text-left","mt-0"],[1,"block","text-sm","font-medium","text-slate-800","mb-1"],[1,"flex","items-center","space-x-2"],["alt","CAPTCHA",1,"h-10","border","border-amber-400","rounded",3,"src"],["type","button",1,"text-xs","text-orange-600","font-semibold",3,"click"],["name","captcha","required","","placeholder","Enter CAPTCHA",1,"w-full","h-10","px-3","mt-2","rounded-md","border","border-amber-300",3,"ngModelChange","ngModel"],["class","text-xs text-red-600",4,"ngIf"],[1,"flex","justify-end","mt-0"],["routerLink","/forgot-password",1,"text-sm","text-orange-600","hover:text-orange-700","font-semibold"],["type","submit",1,"w-full","h-9","bg-gradient-to-r","from-orange-600","to-red-600","hover:from-orange-700","hover:to-red-700","rounded-md","font-semibold","text-white","text-sm","shadow-md","transition-transform","hover:scale-105","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"relative","my-4"],[1,"absolute","inset-0","flex","items-center"],[1,"w-full","border-t","border-amber-300"],[1,"relative","flex","justify-center","text-xs","uppercase"],[1,"bg-white","px-2","text-slate-700","font-semibold"],[1,"w-full","h-9","flex","items-center","justify-center","space-x-2","border","border-amber-300","rounded-md","bg-white","hover:bg-amber-50","transition-colors","font-semibold","text-sm","text-slate-700",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-mail-icon","lucide-mail"],["d","m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7"],["x","2","y","4","width","20","height","16","rx","2"],[1,"text-center","text-xs","text-slate-700","mt-1","border-t","pt-3","border-amber-200","font-medium"],["routerLink","/signup",1,"text-orange-600","hover:text-orange-700","font-semibold","ml-1"],[1,"text-xs","mt-1","text-red-600","font-medium"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-eye-off-icon","lucide-eye-off"],["d","M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"],["d","M14.084 14.158a3 3 0 0 1-4.242-4.242"],["d","M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"],["d","m2 2 20 20"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-eye-icon","lucide-eye"],["d","M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"],["cx","12","cy","12","r","3"],[1,"text-xs","text-red-600"]],template:function(r,a){if(r&1){let m=F();e(0,"div",5),u(1,"div",6)(2,"div",7)(3,"div",8),e(4,"div",9)(5,"div",10)(6,"blockquote",11)(7,"span",12),o(8,'"Share the spark,'),t(),e(9,"span",13),o(10,'spread the knowledge"'),t()(),e(11,"div",14),u(12,"div",15)(13,"div",16)(14,"div",17)(15,"div",18),t(),u(16,"div",19),t()(),e(17,"div",20)(18,"div",21)(19,"div",22)(20,"a",23)(21,"div",24)(22,"span",25),o(23,"\u{1F525}"),t()(),e(24,"span",26),o(25,"IGKNIGHT"),t()()(),e(26,"div",27)(27,"h2",28),o(28,"Welcome Back"),t(),e(29,"p",29),o(30,"Enter your magical library of knowledge"),t(),e(31,"form",30,0),w("ngSubmit",function(){return g(m),f(a.onLogin())}),e(33,"div",31)(34,"label",32),o(35,"Username"),t(),e(36,"input",33,1),I("ngModelChange",function(l){return g(m),S(a.username,l)||(a.username=l),f(l)}),t(),v(38,pe,3,2,"div",34),t(),e(39,"div",31)(40,"label",35),o(41,"Password"),t(),e(42,"div",36)(43,"input",37,2),I("ngModelChange",function(l){return g(m),S(a.password,l)||(a.password=l),f(l)}),t(),e(45,"button",38),w("click",function(){return g(m),f(a.togglePasswordVisibility())}),v(46,ue,6,0,"ng-container",39)(47,ge,3,0,"ng-template",null,3,G),t()(),v(49,ve,3,2,"div",34),t(),e(50,"div",40)(51,"label",41),o(52,"CAPTCHA"),t(),e(53,"div",42),u(54,"img",43),e(55,"button",44),w("click",function(){return g(m),f(a.loadCaptcha())}),o(56,"Refresh"),t()(),e(57,"input",45,4),I("ngModelChange",function(l){return g(m),S(a.captchaInput,l)||(a.captchaInput=l),f(l)}),t(),v(59,xe,2,0,"div",46),t(),e(60,"div",47)(61,"a",48),o(62,"Forgot Password?"),t()(),e(63,"button",49),o(64," Enter the Library "),t()(),e(65,"div",50)(66,"div",51),u(67,"span",52),t(),e(68,"div",53)(69,"span",54),o(70,"or"),t()()(),e(71,"button",55),w("click",function(){return g(m),f(a.signInWithGoogle())}),y(),e(72,"svg",56),u(73,"path",57)(74,"rect",58),t(),q(),e(75,"span"),o(76,"Continue with Google"),t()(),e(77,"div",59),o(78," Don\u2019t have an account? "),e(79,"a",60),o(80,"Join the Library"),t()()()()()()}if(r&2){let m=h(32),c=h(37),l=h(44),le=h(48),j=h(58);s(36),k("ngModel",a.username),s(2),d("ngIf",c.invalid&&c.touched),s(5),d("type",a.showPassword?"text":"password"),k("ngModel",a.password),s(3),d("ngIf",a.showPassword)("ngIfElse",le),s(3),d("ngIf",l.invalid&&l.touched),s(5),d("src",a.captchaImageUrl,D),s(3),k("ngModel",a.captchaInput),s(2),d("ngIf",j.invalid&&j.touched),s(4),d("disabled",m.invalid)}},dependencies:[B,ie,Y,Z,$,re,ne,te,ee,U],encapsulation:2})};var T=class i{constructor(n,r){this.route=n;this.router=r}ngOnInit(){let n=this.route.snapshot.queryParamMap.get("token"),r=this.route.snapshot.queryParamMap.get("email");n?(localStorage.setItem("access_token",n),this.router.navigate(["/"])):this.router.navigate(["/login"])}static \u0275fac=function(r){return new(r||i)(p(H),p(M))};static \u0275cmp=_({type:i,selectors:[["app-oauth-callback"]],standalone:!1,decls:2,vars:0,template:function(r,a){r&1&&(e(0,"p"),o(1,"oauth-callback works!"),t())},encapsulation:2})};var be=[{path:"",component:E},{path:"oauth-callback",component:T}],A=class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=b({type:i});static \u0275inj=x({imports:[P.forChild(be),P]})};var R=class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=b({type:i});static \u0275inj=x({providers:[z],imports:[C]})};var ae=class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=b({type:i});static \u0275inj=x({imports:[C,oe,A,R]})};export{ae as AuthModule};
